apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: tarka
  namespace: tarka
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: tarka
    kind: SecretStore
  target:
    name: tarka
    creationPolicy: Owner
  data:
    # GCP Vertex AI
    - secretKey: GCP_WIF_CRED_JSON
      remoteRef:
        key: tarka
        property: GCP_WIF_CRED_JSON

    # PostgreSQL
    - secretKey: POSTGRES_PASSWORD
      remoteRef:
        key: tarka
        property: POSTGRES_PASSWORD

    # Authentication (modern OIDC variables)
    - secretKey: AUTH_SESSION_SECRET
      remoteRef:
        key: tarka
        property: AUTH_SESSION_SECRET
    - secretKey: ADMIN_INITIAL_USERNAME
      remoteRef:
        key: tarka
        property: ADMIN_INITIAL_USERNAME
    - secretKey: ADMIN_INITIAL_PASSWORD
      remoteRef:
        key: tarka
        property: ADMIN_INITIAL_PASSWORD
    - secretKey: OIDC_CLIENT_ID
      remoteRef:
        key: tarka
        property: OIDC_CLIENT_ID
    - secretKey: OIDC_CLIENT_SECRET
      remoteRef:
        key: tarka
        property: OIDC_CLIENT_SECRET
    - secretKey: OIDC_DISCOVERY_URL
      remoteRef:
        key: tarka
        property: OIDC_DISCOVERY_URL

    # LangSmith (optional)
    - secretKey: LANGSMITH_API_KEY
      remoteRef:
        key: tarka
        property: LANGSMITH_API_KEY

    # Anthropic API (optional, for LLM when LLM_PROVIDER=anthropic)
    - secretKey: ANTHROPIC_API_KEY
      remoteRef:
        key: tarka
        property: ANTHROPIC_API_KEY

    # GitHub App credentials (optional, for GitHub evidence and chat tools)
    - secretKey: GITHUB_APP_ID
      remoteRef:
        key: tarka
        property: GITHUB_APP_ID
    - secretKey: GITHUB_APP_PRIVATE_KEY
      remoteRef:
        key: tarka
        property: GITHUB_APP_PRIVATE_KEY
    - secretKey: GITHUB_APP_INSTALLATION_ID
      remoteRef:
        key: tarka
        property: GITHUB_APP_INSTALLATION_ID
